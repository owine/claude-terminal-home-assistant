name: Lint

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  hadolint:
    name: Dockerfile
    runs-on: ubuntu-24.04
    steps:
      - name: Checkout
        uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6

      - name: Run hadolint
        uses: hadolint/hadolint-action@54c9adbab1582c2ef04b2016b760714a4bfde3cf # v3.1.0
        with:
          dockerfile: claude-terminal/Dockerfile
          config: .hadolint.yaml
          failure-threshold: error

  shellcheck:
    name: Shell Scripts
    runs-on: ubuntu-24.04
    steps:
      - name: Checkout
        uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6

      - name: Run shellcheck
        uses: ludeeus/action-shellcheck@00b27aa7cb85167568cb619918ee9e8e48a1e9f8 # v2.0.0
        with:
          scandir: './claude-terminal'
          severity: warning
        env:
          SHELLCHECK_OPTS: --external-sources

  yamllint:
    name: YAML Files
    runs-on: ubuntu-24.04
    steps:
      - name: Checkout
        uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6

      - name: Run yamllint
        uses: ibiqlik/action-yamllint@2576378a8e339169678f9939646ee3ee325e845c # v3.1.1
        with:
          config_file: .yamllint.yml
          file_or_dir: |
            claude-terminal/config.yaml
            claude-terminal/build.yaml
            .github/workflows/

  actionlint:
    name: GitHub Actions
    runs-on: ubuntu-24.04
    steps:
      - name: Checkout
        uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6

      - name: Run actionlint
        uses: reviewdog/action-actionlint@7eeec1dd160c2301eb28e1568721837d084558ad # v1.57.0
        with:
          fail_on_error: true
          filter_mode: nofilter
