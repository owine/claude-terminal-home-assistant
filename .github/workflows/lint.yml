name: Lint

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  hadolint:
    name: Dockerfile
    runs-on: ubuntu-24.04
    steps:
      - name: Checkout
        uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6

      - name: Run hadolint
        uses: hadolint/hadolint-action@54c9adbab1582c2ef04b2016b760714a4bfde3cf # v3.1.0
        with:
          dockerfile: claude-terminal/Dockerfile
          config: .hadolint.yaml
          failure-threshold: error

  shellcheck:
    name: Shell Scripts
    runs-on: ubuntu-24.04
    steps:
      - name: Checkout
        uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6

      # Use pre-installed shellcheck on GitHub Actions runners
      - name: Run shellcheck
        run: |
          shellcheck --version
          shellcheck --external-sources --severity=error \
            claude-terminal/run.sh \
            claude-terminal/scripts/*.sh

  yamllint:
    name: YAML Files
    runs-on: ubuntu-24.04
    steps:
      - name: Checkout
        uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6

      # Use pre-installed yamllint on GitHub Actions runners
      - name: Run yamllint
        run: |
          yamllint --version
          yamllint -c .yamllint.yml \
            claude-terminal/config.yaml \
            claude-terminal/build.yaml \
            .github/workflows/

  actionlint:
    name: GitHub Actions
    runs-on: ubuntu-24.04
    steps:
      - name: Checkout
        uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6

      - name: Run actionlint
        uses: raven-actions/actionlint@e01d1ea33dd6a5ed517d95b4c0c357560ac6f518 # v2.0.0
