# Claude Terminal tmux configuration

# Use the inherited terminal type (better compatibility)
set-option -g default-terminal $TERM

# Keep panes/windows open when command exits (allows restart)
set -g remain-on-exit on

# Start window and pane numbering at 1 (more intuitive)
set-option -g base-index 1
setw -g pane-base-index 1

# Status bar styling
set -g status-style "fg=white,bg=colour236"
set -g status-left ''
set -g status-right '%a %m-%d %H:%M'

# Mouse support - only enable when NOT using ttyd
# ttyd has its own mouse handling that works better for web terminals
if-shell '[ -z "$TTYD" ]' {
    set -g mouse on
}

# OSC 52 clipboard support - sends copied text to browser clipboard                                                                                                                                                                                                                                                                                                                                                                                     
set -g set-clipboard on
set -g allow-passthrough on

# Increase scroll-back buffer significantly (default is 2000)
set -g history-limit 50000

# Faster escape time for better vim/nano responsiveness
set -sg escape-time 0

# vi-style keys in copy mode
setw -g mode-keys vi

# Advanced copy mode improvements for when mouse mode is enabled
# These work well even with ttyd's mouse handling

# Enter copy mode with mouse scroll (when mouse is enabled)
bind -n WheelUpPane if-shell -F -t = "#{mouse_any_flag}" "send-keys -M" "if -Ft= '#{pane_in_mode}' 'send-keys -M' 'select-pane -t=; copy-mode -e; send-keys -M'"
bind -n WheelDownPane select-pane -t= \; send-keys -M

# Copy on mouse drag end - copies to tmux buffer (OSC 52 handles clipboard)                                                                                                                                                                                                                                                                                                                                                                             
bind -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-selection-and-cancel

# Double-click word selection
bind -T copy-mode-vi DoubleClick1Pane select-pane \; send-keys -X select-word
bind -n DoubleClick1Pane select-pane \; copy-mode -M \; send-keys -X select-word

# Triple-click line selection
bind -T copy-mode-vi TripleClick1Pane select-pane \; send-keys -X select-line
bind -n TripleClick1Pane select-pane \; copy-mode -M \; send-keys -X select-line
